operations:
  - src_a: "X"
    src_b: "input_B"
    output: "tanh_softplus"
    src_a_dims: [32, 256]
    src_b_dims: [32, 256]
    output_pack_dims: [32, 32]
    input_format: "Float16_b"
    output_format: "Float16_b"
    unpacker: "UnpackerA"
    math:
      fpu: "Datacopy"
      sfpu:
        # 1) Initial state:
        #    tile0 = x  (input from FPU Datacopy phase)
        #    All other tiles are free.

        # 2) tile1 = 1.0
        # Create constant 1.0, used as a multiplicative identity for both the softplus and tanh parts.
        - type: "UnarySfpu"
          operation: "Fill"
          approximation_mode: "No"
          dst_dest_tile_index: 1
          iterations: 32
          fill_const_value: 1.0

        # 3) tile4 = x
        # Copy x from tile0 into tile4 while keeping tile0 intact. Use multiplication by 1.0: tile4 = tile0 * tile1 = x * 1.
        - type: "BinarySfpu"
          operation: "SfpuElwmul"
          approximation_mode: "No"
          iterations: 32
          src1_dest_tile_index: 0   # x
          src2_dest_tile_index: 1   # 1.0
          dst_dest_tile_index: 4    # tile4 = x

        # 4) tile4 = exp(x)
        - type: "UnarySfpu"
          operation: "Exp"
          approximation_mode: "No"
          dst_dest_tile_index: 4
          iterations: 32

        # 5) tile4 = exp(x) + 1.0
        - type: "BinarySfpu"
          operation: "SfpuElwadd"
          approximation_mode: "No"
          iterations: 32
          src1_dest_tile_index: 4   # exp(x)
          src2_dest_tile_index: 1   # 1.0
          dst_dest_tile_index: 4    # exp(x) + 1.0

        # 6) tile4 = log(exp(x) + 1.0) = softplus(x) = y
        - type: "UnarySfpu"
          operation: "Log"
          approximation_mode: "No"
          dst_dest_tile_index: 4
          iterations: 32

        # At this point:
        #   tile0 = x          (original input is preserved)
        #   tile1 = 1.0
        #   tile4 = y = softplus(x)

        - type: "UnarySfpu"
          operation: "Tanh"
          approximation_mode: "No"
          dst_dest_tile_index: 0
          iterations: 32

        # 14) tile0 = x * tanh(softplus(x))
        # Final result is written into tile0.
        - type: "BinarySfpu"
          operation: "SfpuElwmul"
          approximation_mode: "No"
          iterations: 32
          src1_dest_tile_index: 0   # x
          src2_dest_tile_index: 4   # tanh(softplus(x))
          dst_dest_tile_index: 0    # mish(x) in tile0

    packer: "Packer"
    dest_acc: "Yes"
    math_fidelity: "HiFi4"
